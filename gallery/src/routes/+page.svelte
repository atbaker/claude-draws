<script lang="ts">
	import type { PageData } from './$types';
	import Header from '$lib/components/Header.svelte';
	import Footer from '$lib/components/Footer.svelte';
	import ArtworkCard from '$lib/components/ArtworkCard.svelte';

	let { data }: { data: PageData } = $props();

	// Cycle through Kid Pix colors for cards
	const cardColors = [
		'bg-kidpix-yellow',
		'bg-kidpix-cyan',
		'bg-kidpix-pink',
		'bg-kidpix-orange',
		'bg-white'
	];

	// Get 8 most recent non-autogenerated artworks (sorted by createdAt descending)
	const recentArtworks = data.artworks
		.filter((artwork) => !artwork.autogenerated)
		.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime())
		.slice(0, 8);
</script>

<svelte:head>
	<title>Claude Draws - AI-Generated Kid Pix Art</title>
	<meta
		name="description"
		content="Gallery of crowdsourced illustrations created by Claude for Chrome using Kid Pix"
	/>
</svelte:head>

<div class="min-h-screen">
	<Header />

	<!-- Main Content -->
	<main class="container mx-auto p-4 sm:p-8">
		<!-- Livestream Section -->
		<div class="max-w-4xl mx-auto mb-8">
			<div class="bg-kidpix-purple border-4 border-black shadow-chunky-lg overflow-hidden">
				<div class="aspect-video bg-black">
					<iframe
						width="100%"
						height="100%"
						src="https://www.youtube.com/embed/LqctlqfPLZE?si=2hf5ETxiv9LTWLC8"
						title="YouTube video player"
						frameborder="0"
						allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
						referrerpolicy="strict-origin-when-cross-origin"
						allowfullscreen
					></iframe>
				</div>
			</div>
		</div>

		<!-- Description Section -->
		<div class="max-w-3xl mx-auto mb-8">
			<div class="bg-kidpix-yellow border-4 border-black p-6 shadow-chunky-lg">
				<p class="text-lg sm:text-xl font-bold text-center leading-relaxed">
					Watch Claude for Chrome create Kid Pix art from your Reddit requests.
				</p>
			</div>
		</div>

		<!-- Action Buttons -->
		<div class="flex flex-wrap justify-center gap-4 mb-12">
			<a
				href="https://reddit.com/r/ClaudeDraws"
				target="_blank"
				rel="noopener noreferrer"
				class="bg-kidpix-blue text-white font-bold text-lg px-6 py-3 border-4 border-black shadow-chunky hover:shadow-chunky-hover hover:translate-x-1 hover:translate-y-1 uppercase transition-all"
			>
				Subreddit
			</a>
			<a
				href="https://github.com/atbaker/claude-draws"
				target="_blank"
				rel="noopener noreferrer"
				class="bg-kidpix-purple text-white font-bold text-lg px-6 py-3 border-4 border-black shadow-chunky hover:shadow-chunky-hover hover:translate-x-1 hover:translate-y-1 uppercase transition-all"
			>
				GitHub
			</a>
			<a
				href="/about"
				class="bg-kidpix-red text-white font-bold text-lg px-6 py-3 border-4 border-black shadow-chunky hover:shadow-chunky-hover hover:translate-x-1 hover:translate-y-1 uppercase transition-all"
			>
				About this project
			</a>
		</div>

		<!-- Recent Artworks Section -->
		<div class="mb-8">
			<div class="bg-kidpix-cyan border-4 border-black p-4 shadow-chunky-lg mb-6">
				<h2 class="text-3xl font-black uppercase text-center">Recent Artworks</h2>
			</div>

			{#if recentArtworks.length === 0}
				<div class="text-center py-12">
					<div class="inline-block bg-kidpix-pink border-4 border-black p-8 shadow-chunky-lg">
						<p class="text-2xl font-black uppercase">No artworks yet. Check back soon!</p>
					</div>
				</div>
			{:else}
				<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mb-6">
					{#each recentArtworks as artwork, i}
						<ArtworkCard {artwork} color={cardColors[i % cardColors.length]} index={i} />
					{/each}
				</div>

				<!-- See More Button -->
				<div class="text-center">
					<a
						href="/gallery"
						class="inline-block bg-kidpix-green text-black font-bold text-xl px-8 py-4 border-4 border-black shadow-chunky hover:shadow-chunky-hover hover:translate-x-1 hover:translate-y-1 uppercase transition-all"
					>
						See More â†’
					</a>
				</div>
			{/if}
		</div>
	</main>

	<Footer />
</div>
